{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-product-trend.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport { format, subDays, eachDayOfInterval } from \"date-fns\";\nimport type { ProductTrend } from \"./types\";\n\nexport async function getProductTrend(\n  days: number = 30,\n): Promise<ProductTrend[]> {\n  const supabase = await createClient();\n\n  const endDate = new Date();\n  const startDate = subDays(endDate, days);\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"created_at, status\")\n    .gte(\"created_at\", startDate.toISOString());\n\n  if (error) throw error;\n\n  const interval = eachDayOfInterval({ start: startDate, end: endDate });\n\n  const trendMap: Record<\n    string,\n    { newProducts: number; activeProducts: number }\n  > = {};\n\n  interval.forEach((date) => {\n    const dateKey = format(date, \"yyyy-MM-dd\");\n    trendMap[dateKey] = { newProducts: 0, activeProducts: 0 };\n  });\n\n  data?.forEach((p) => {\n    const dateKey = format(new Date(p.created_at!), \"yyyy-MM-dd\");\n    if (trendMap[dateKey]) {\n      trendMap[dateKey].newProducts += 1;\n    }\n  });\n\n  let cumulativeActive = 0;\n  return interval.map((date) => {\n    const dateKey = format(date, \"yyyy-MM-dd\");\n    cumulativeActive += trendMap[dateKey].newProducts;\n    return {\n      date: dateKey,\n      newProducts: trendMap[dateKey].newProducts,\n      activeProducts: cumulativeActive,\n    };\n  });\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;;;;;AAGO,eAAe,gBACpB,OAAe,EAAE;IAEjB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,UAAU,IAAI;IACpB,MAAM,YAAY,IAAA,iJAAO,EAAC,SAAS;IAEnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC,sBACP,GAAG,CAAC,cAAc,UAAU,WAAW;IAE1C,IAAI,OAAO,MAAM;IAEjB,MAAM,WAAW,IAAA,qKAAiB,EAAC;QAAE,OAAO;QAAW,KAAK;IAAQ;IAEpE,MAAM,WAGF,CAAC;IAEL,SAAS,OAAO,CAAC,CAAC;QAChB,MAAM,UAAU,IAAA,+JAAM,EAAC,MAAM;QAC7B,QAAQ,CAAC,QAAQ,GAAG;YAAE,aAAa;YAAG,gBAAgB;QAAE;IAC1D;IAEA,MAAM,QAAQ,CAAC;QACb,MAAM,UAAU,IAAA,+JAAM,EAAC,IAAI,KAAK,EAAE,UAAU,GAAI;QAChD,IAAI,QAAQ,CAAC,QAAQ,EAAE;YACrB,QAAQ,CAAC,QAAQ,CAAC,WAAW,IAAI;QACnC;IACF;IAEA,IAAI,mBAAmB;IACvB,OAAO,SAAS,GAAG,CAAC,CAAC;QACnB,MAAM,UAAU,IAAA,+JAAM,EAAC,MAAM;QAC7B,oBAAoB,QAAQ,CAAC,QAAQ,CAAC,WAAW;QACjD,OAAO;YACL,MAAM;YACN,aAAa,QAAQ,CAAC,QAAQ,CAAC,WAAW;YAC1C,gBAAgB;QAClB;IACF;AACF;;;IA5CsB;;AAAA,+OAAA"}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-visitor-stats.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\n\nexport interface VisitorStats {\n  totalPageViews: number;\n  uniqueVisitors: number;\n  totalSessions: number;\n  avgSessionDuration: number;\n  bounceRate: number;\n  pageViewsGrowth: number;\n  visitorsGrowth: number;\n}\n\nexport async function getVisitorStats(\n  days: number = 30,\n): Promise<VisitorStats> {\n  const supabase = await createClient();\n\n  const now = new Date();\n  const periodStart = new Date(now);\n  periodStart.setDate(periodStart.getDate() - days);\n\n  const prevPeriodStart = new Date(periodStart);\n  prevPeriodStart.setDate(prevPeriodStart.getDate() - days);\n\n  const [currentPageViews, prevPageViews, currentSessions] = await Promise.all([\n    supabase\n      .from(\"page_views\")\n      .select(\"visitor_id\", { count: \"exact\" })\n      .gte(\"created_at\", periodStart.toISOString()),\n    supabase\n      .from(\"page_views\")\n      .select(\"visitor_id\", { count: \"exact\" })\n      .gte(\"created_at\", prevPeriodStart.toISOString())\n      .lt(\"created_at\", periodStart.toISOString()),\n    supabase\n      .from(\"sessions\")\n      .select(\"duration_seconds, is_bounce, visitor_id\")\n      .gte(\"started_at\", periodStart.toISOString()),\n  ]);\n\n  const totalPageViews = currentPageViews.count || 0;\n  const prevTotalPageViews = prevPageViews.count || 0;\n\n  const uniqueVisitors = new Set(\n    (currentPageViews.data || []).map((p) => p.visitor_id),\n  ).size;\n  const prevUniqueVisitors = new Set(\n    (prevPageViews.data || []).map((p) => p.visitor_id),\n  ).size;\n\n  const sessions = currentSessions.data || [];\n  const totalSessions = sessions.length;\n\n  const avgSessionDuration =\n    sessions.length > 0\n      ? sessions.reduce((sum, s) => sum + (s.duration_seconds || 0), 0) /\n        sessions.length\n      : 0;\n\n  const bouncedSessions = sessions.filter((s) => s.is_bounce).length;\n  const bounceRate =\n    totalSessions > 0 ? (bouncedSessions / totalSessions) * 100 : 0;\n\n  const pageViewsGrowth =\n    prevTotalPageViews > 0\n      ? ((totalPageViews - prevTotalPageViews) / prevTotalPageViews) * 100\n      : totalPageViews > 0\n        ? 100\n        : 0;\n\n  const visitorsGrowth =\n    prevUniqueVisitors > 0\n      ? ((uniqueVisitors - prevUniqueVisitors) / prevUniqueVisitors) * 100\n      : uniqueVisitors > 0\n        ? 100\n        : 0;\n\n  return {\n    totalPageViews,\n    uniqueVisitors,\n    totalSessions,\n    avgSessionDuration: Math.round(avgSessionDuration),\n    bounceRate: Math.round(bounceRate * 10) / 10,\n    pageViewsGrowth: Math.round(pageViewsGrowth * 10) / 10,\n    visitorsGrowth: Math.round(visitorsGrowth * 10) / 10,\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;AAYO,eAAe,gBACpB,OAAe,EAAE;IAEjB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,MAAM,IAAI;IAChB,MAAM,cAAc,IAAI,KAAK;IAC7B,YAAY,OAAO,CAAC,YAAY,OAAO,KAAK;IAE5C,MAAM,kBAAkB,IAAI,KAAK;IACjC,gBAAgB,OAAO,CAAC,gBAAgB,OAAO,KAAK;IAEpD,MAAM,CAAC,kBAAkB,eAAe,gBAAgB,GAAG,MAAM,QAAQ,GAAG,CAAC;QAC3E,SACG,IAAI,CAAC,cACL,MAAM,CAAC,cAAc;YAAE,OAAO;QAAQ,GACtC,GAAG,CAAC,cAAc,YAAY,WAAW;QAC5C,SACG,IAAI,CAAC,cACL,MAAM,CAAC,cAAc;YAAE,OAAO;QAAQ,GACtC,GAAG,CAAC,cAAc,gBAAgB,WAAW,IAC7C,EAAE,CAAC,cAAc,YAAY,WAAW;QAC3C,SACG,IAAI,CAAC,YACL,MAAM,CAAC,2CACP,GAAG,CAAC,cAAc,YAAY,WAAW;KAC7C;IAED,MAAM,iBAAiB,iBAAiB,KAAK,IAAI;IACjD,MAAM,qBAAqB,cAAc,KAAK,IAAI;IAElD,MAAM,iBAAiB,IAAI,IACzB,CAAC,iBAAiB,IAAI,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,IAAM,EAAE,UAAU,GACrD,IAAI;IACN,MAAM,qBAAqB,IAAI,IAC7B,CAAC,cAAc,IAAI,IAAI,EAAE,EAAE,GAAG,CAAC,CAAC,IAAM,EAAE,UAAU,GAClD,IAAI;IAEN,MAAM,WAAW,gBAAgB,IAAI,IAAI,EAAE;IAC3C,MAAM,gBAAgB,SAAS,MAAM;IAErC,MAAM,qBACJ,SAAS,MAAM,GAAG,IACd,SAAS,MAAM,CAAC,CAAC,KAAK,IAAM,MAAM,CAAC,EAAE,gBAAgB,IAAI,CAAC,GAAG,KAC7D,SAAS,MAAM,GACf;IAEN,MAAM,kBAAkB,SAAS,MAAM,CAAC,CAAC,IAAM,EAAE,SAAS,EAAE,MAAM;IAClE,MAAM,aACJ,gBAAgB,IAAI,AAAC,kBAAkB,gBAAiB,MAAM;IAEhE,MAAM,kBACJ,qBAAqB,IACjB,AAAC,CAAC,iBAAiB,kBAAkB,IAAI,qBAAsB,MAC/D,iBAAiB,IACf,MACA;IAER,MAAM,iBACJ,qBAAqB,IACjB,AAAC,CAAC,iBAAiB,kBAAkB,IAAI,qBAAsB,MAC/D,iBAAiB,IACf,MACA;IAER,OAAO;QACL;QACA;QACA;QACA,oBAAoB,KAAK,KAAK,CAAC;QAC/B,YAAY,KAAK,KAAK,CAAC,aAAa,MAAM;QAC1C,iBAAiB,KAAK,KAAK,CAAC,kBAAkB,MAAM;QACpD,gBAAgB,KAAK,KAAK,CAAC,iBAAiB,MAAM;IACpD;AACF;;;IA1EsB;;AAAA,+OAAA"}},
    {"offset": {"line": 116, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-popular-pages.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport { subDays } from \"date-fns\";\n\nexport interface PopularPage {\n  path: string;\n  views: number;\n  uniqueVisitors: number;\n}\n\nexport async function getPopularPages(\n  days: number = 30,\n  limit: number = 10,\n): Promise<PopularPage[]> {\n  const supabase = await createClient();\n\n  const startDate = subDays(new Date(), days);\n\n  const { data } = await supabase\n    .from(\"page_views\")\n    .select(\"page_path, visitor_id\")\n    .gte(\"created_at\", startDate.toISOString());\n\n  if (!data || data.length === 0) return [];\n\n  const pageMap: Record<string, { views: number; visitors: Set<string> }> = {};\n\n  data.forEach((pv) => {\n    if (!pageMap[pv.page_path]) {\n      pageMap[pv.page_path] = { views: 0, visitors: new Set() };\n    }\n    pageMap[pv.page_path].views += 1;\n    pageMap[pv.page_path].visitors.add(pv.visitor_id);\n  });\n\n  return Object.entries(pageMap)\n    .map(([path, stats]) => ({\n      path,\n      views: stats.views,\n      uniqueVisitors: stats.visitors.size,\n    }))\n    .sort((a, b) => b.views - a.views)\n    .slice(0, limit);\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;AAQO,eAAe,gBACpB,OAAe,EAAE,EACjB,QAAgB,EAAE;IAElB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,YAAY,IAAA,iJAAO,EAAC,IAAI,QAAQ;IAEtC,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,SACpB,IAAI,CAAC,cACL,MAAM,CAAC,yBACP,GAAG,CAAC,cAAc,UAAU,WAAW;IAE1C,IAAI,CAAC,QAAQ,KAAK,MAAM,KAAK,GAAG,OAAO,EAAE;IAEzC,MAAM,UAAoE,CAAC;IAE3E,KAAK,OAAO,CAAC,CAAC;QACZ,IAAI,CAAC,OAAO,CAAC,GAAG,SAAS,CAAC,EAAE;YAC1B,OAAO,CAAC,GAAG,SAAS,CAAC,GAAG;gBAAE,OAAO;gBAAG,UAAU,IAAI;YAAM;QAC1D;QACA,OAAO,CAAC,GAAG,SAAS,CAAC,CAAC,KAAK,IAAI;QAC/B,OAAO,CAAC,GAAG,SAAS,CAAC,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,UAAU;IAClD;IAEA,OAAO,OAAO,OAAO,CAAC,SACnB,GAAG,CAAC,CAAC,CAAC,MAAM,MAAM,GAAK,CAAC;YACvB;YACA,OAAO,MAAM,KAAK;YAClB,gBAAgB,MAAM,QAAQ,CAAC,IAAI;QACrC,CAAC,GACA,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK,EAChC,KAAK,CAAC,GAAG;AACd;;;IAjCsB;;AAAA,+OAAA"}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-product-stats.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport type { ProductStats } from \"./types\";\n\nexport async function getProductStats(): Promise<ProductStats> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase\n    .from(\"products\")\n    .select(\"status, created_at\");\n\n  if (error) throw error;\n\n  const now = new Date();\n  const thisMonthStart = new Date(now.getFullYear(), now.getMonth(), 1);\n  const lastMonthStart = new Date(now.getFullYear(), now.getMonth() - 1, 1);\n\n  const thisMonthProducts = (data || []).filter(\n    (p) => new Date(p.created_at!) >= thisMonthStart,\n  );\n  const lastMonthProducts = (data || []).filter(\n    (p) =>\n      new Date(p.created_at!) >= lastMonthStart &&\n      new Date(p.created_at!) < thisMonthStart,\n  );\n\n  const growthRate =\n    lastMonthProducts.length > 0\n      ? ((thisMonthProducts.length - lastMonthProducts.length) /\n          lastMonthProducts.length) *\n        100\n      : thisMonthProducts.length > 0\n        ? 100\n        : 0;\n\n  return {\n    total: data?.length || 0,\n    active: data?.filter((p) => p.status === \"active\").length || 0,\n    draft: data?.filter((p) => p.status === \"draft\").length || 0,\n    archived: data?.filter((p) => p.status === \"archived\").length || 0,\n    thisMonthNew: thisMonthProducts.length,\n    lastMonthNew: lastMonthProducts.length,\n    growthRate: Math.round(growthRate * 10) / 10,\n  };\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;AAGO,eAAe;IACpB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAC3B,IAAI,CAAC,YACL,MAAM,CAAC;IAEV,IAAI,OAAO,MAAM;IAEjB,MAAM,MAAM,IAAI;IAChB,MAAM,iBAAiB,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,IAAI;IACnE,MAAM,iBAAiB,IAAI,KAAK,IAAI,WAAW,IAAI,IAAI,QAAQ,KAAK,GAAG;IAEvE,MAAM,oBAAoB,CAAC,QAAQ,EAAE,EAAE,MAAM,CAC3C,CAAC,IAAM,IAAI,KAAK,EAAE,UAAU,KAAM;IAEpC,MAAM,oBAAoB,CAAC,QAAQ,EAAE,EAAE,MAAM,CAC3C,CAAC,IACC,IAAI,KAAK,EAAE,UAAU,KAAM,kBAC3B,IAAI,KAAK,EAAE,UAAU,IAAK;IAG9B,MAAM,aACJ,kBAAkB,MAAM,GAAG,IACvB,AAAC,CAAC,kBAAkB,MAAM,GAAG,kBAAkB,MAAM,IACnD,kBAAkB,MAAM,GAC1B,MACA,kBAAkB,MAAM,GAAG,IACzB,MACA;IAER,OAAO;QACL,OAAO,MAAM,UAAU;QACvB,QAAQ,MAAM,OAAO,CAAC,IAAM,EAAE,MAAM,KAAK,UAAU,UAAU;QAC7D,OAAO,MAAM,OAAO,CAAC,IAAM,EAAE,MAAM,KAAK,SAAS,UAAU;QAC3D,UAAU,MAAM,OAAO,CAAC,IAAM,EAAE,MAAM,KAAK,YAAY,UAAU;QACjE,cAAc,kBAAkB,MAAM;QACtC,cAAc,kBAAkB,MAAM;QACtC,YAAY,KAAK,KAAK,CAAC,aAAa,MAAM;IAC5C;AACF;;;IAxCsB;;AAAA,+OAAA"}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-category-distribution.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport type { CategoryDistribution } from \"./types\";\n\nconst CATEGORY_COLORS: Record<string, string> = {\n  marble: \"hsl(210, 40%, 60%)\",\n  granite: \"hsl(220, 35%, 50%)\",\n  travertine: \"hsl(35, 60%, 55%)\",\n  onyx: \"hsl(280, 40%, 50%)\",\n  limestone: \"hsl(45, 50%, 60%)\",\n  quartzite: \"hsl(180, 45%, 50%)\",\n};\n\nconst CATEGORY_LABELS: Record<string, string> = {\n  marble: \"Mermer\",\n  granite: \"Granit\",\n  travertine: \"Traverten\",\n  onyx: \"Oniks\",\n  limestone: \"Kireçtaşı\",\n  quartzite: \"Kuvarsit\",\n};\n\nexport async function getCategoryDistribution(): Promise<\n  CategoryDistribution[]\n> {\n  const supabase = await createClient();\n\n  const { data, error } = await supabase.from(\"products\").select(\"category\");\n\n  if (error) throw error;\n\n  const total = data?.length || 0;\n  if (total === 0) return [];\n\n  const categoryCounts: Record<string, number> = {};\n  data?.forEach((p) => {\n    const cat = p.category;\n    categoryCounts[cat] = (categoryCounts[cat] || 0) + 1;\n  });\n\n  return Object.entries(categoryCounts)\n    .map(([category, count]) => ({\n      category: CATEGORY_LABELS[category] || category,\n      count,\n      percentage: Math.round((count / total) * 100 * 10) / 10,\n      fill: CATEGORY_COLORS[category] || \"hsl(0, 0%, 50%)\",\n    }))\n    .sort((a, b) => b.count - a.count);\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;AAGA,MAAM,kBAA0C;IAC9C,QAAQ;IACR,SAAS;IACT,YAAY;IACZ,MAAM;IACN,WAAW;IACX,WAAW;AACb;AAEA,MAAM,kBAA0C;IAC9C,QAAQ;IACR,SAAS;IACT,YAAY;IACZ,MAAM;IACN,WAAW;IACX,WAAW;AACb;AAEO,eAAe;IAGpB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,SAAS,IAAI,CAAC,YAAY,MAAM,CAAC;IAE/D,IAAI,OAAO,MAAM;IAEjB,MAAM,QAAQ,MAAM,UAAU;IAC9B,IAAI,UAAU,GAAG,OAAO,EAAE;IAE1B,MAAM,iBAAyC,CAAC;IAChD,MAAM,QAAQ,CAAC;QACb,MAAM,MAAM,EAAE,QAAQ;QACtB,cAAc,CAAC,IAAI,GAAG,CAAC,cAAc,CAAC,IAAI,IAAI,CAAC,IAAI;IACrD;IAEA,OAAO,OAAO,OAAO,CAAC,gBACnB,GAAG,CAAC,CAAC,CAAC,UAAU,MAAM,GAAK,CAAC;YAC3B,UAAU,eAAe,CAAC,SAAS,IAAI;YACvC;YACA,YAAY,KAAK,KAAK,CAAC,AAAC,QAAQ,QAAS,MAAM,MAAM;YACrD,MAAM,eAAe,CAAC,SAAS,IAAI;QACrC,CAAC,GACA,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,KAAK,GAAG,EAAE,KAAK;AACrC;;;IA1BsB;;AAAA,+OAAA"}},
    {"offset": {"line": 248, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/get-daily-analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport { format, subDays, eachDayOfInterval, parseISO } from \"date-fns\";\n\nexport interface DailyAnalytics {\n  date: string;\n  pageViews: number;\n  uniqueVisitors: number;\n  sessions: number;\n}\n\nexport async function getDailyAnalytics(\n  days: number = 30,\n): Promise<DailyAnalytics[]> {\n  const supabase = await createClient();\n\n  const endDate = new Date();\n  const startDate = subDays(endDate, days);\n\n  const { data: pageViews } = await supabase\n    .from(\"page_views\")\n    .select(\"created_at, visitor_id, session_id\")\n    .gte(\"created_at\", startDate.toISOString());\n\n  const interval = eachDayOfInterval({ start: startDate, end: endDate });\n\n  const dailyMap: Record<\n    string,\n    { pageViews: number; visitors: Set<string>; sessions: Set<string> }\n  > = {};\n\n  interval.forEach((date) => {\n    const dateKey = format(date, \"yyyy-MM-dd\");\n    dailyMap[dateKey] = {\n      pageViews: 0,\n      visitors: new Set(),\n      sessions: new Set(),\n    };\n  });\n\n  (pageViews || []).forEach((pv) => {\n    const dateKey = format(parseISO(pv.created_at!), \"yyyy-MM-dd\");\n    if (dailyMap[dateKey]) {\n      dailyMap[dateKey].pageViews += 1;\n      dailyMap[dateKey].visitors.add(pv.visitor_id);\n      dailyMap[dateKey].sessions.add(pv.session_id);\n    }\n  });\n\n  return interval.map((date) => {\n    const dateKey = format(date, \"yyyy-MM-dd\");\n    const day = dailyMap[dateKey];\n    return {\n      date: dateKey,\n      pageViews: day.pageViews,\n      uniqueVisitors: day.visitors.size,\n      sessions: day.sessions.size,\n    };\n  });\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AAAA;AAAA;;;;;AASO,eAAe,kBACpB,OAAe,EAAE;IAEjB,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,UAAU,IAAI;IACpB,MAAM,YAAY,IAAA,iJAAO,EAAC,SAAS;IAEnC,MAAM,EAAE,MAAM,SAAS,EAAE,GAAG,MAAM,SAC/B,IAAI,CAAC,cACL,MAAM,CAAC,sCACP,GAAG,CAAC,cAAc,UAAU,WAAW;IAE1C,MAAM,WAAW,IAAA,qKAAiB,EAAC;QAAE,OAAO;QAAW,KAAK;IAAQ;IAEpE,MAAM,WAGF,CAAC;IAEL,SAAS,OAAO,CAAC,CAAC;QAChB,MAAM,UAAU,IAAA,+JAAM,EAAC,MAAM;QAC7B,QAAQ,CAAC,QAAQ,GAAG;YAClB,WAAW;YACX,UAAU,IAAI;YACd,UAAU,IAAI;QAChB;IACF;IAEA,CAAC,aAAa,EAAE,EAAE,OAAO,CAAC,CAAC;QACzB,MAAM,UAAU,IAAA,+JAAM,EAAC,IAAA,mJAAQ,EAAC,GAAG,UAAU,GAAI;QACjD,IAAI,QAAQ,CAAC,QAAQ,EAAE;YACrB,QAAQ,CAAC,QAAQ,CAAC,SAAS,IAAI;YAC/B,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,UAAU;YAC5C,QAAQ,CAAC,QAAQ,CAAC,QAAQ,CAAC,GAAG,CAAC,GAAG,UAAU;QAC9C;IACF;IAEA,OAAO,SAAS,GAAG,CAAC,CAAC;QACnB,MAAM,UAAU,IAAA,+JAAM,EAAC,MAAM;QAC7B,MAAM,MAAM,QAAQ,CAAC,QAAQ;QAC7B,OAAO;YACL,MAAM;YACN,WAAW,IAAI,SAAS;YACxB,gBAAgB,IAAI,QAAQ,CAAC,IAAI;YACjC,UAAU,IAAI,QAAQ,CAAC,IAAI;QAC7B;IACF;AACF;;;IAhDsB;;AAAA,+OAAA"}},
    {"offset": {"line": 308, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/app/utils/slug-redirect.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/supabase/server\";\nimport type { Tables } from \"@/supabase/database.types\";\n\ntype Product = Tables<\"products\">;\n\ninterface ResolveResult {\n  found: boolean;\n  redirect?: string;\n  product?: Product;\n}\n\nexport async function resolveSlugWithRedirect(\n  slug: string,\n): Promise<ResolveResult> {\n  const supabase = await createClient();\n\n  const { data: product } = await supabase\n    .from(\"products\")\n    .select(\"*\")\n    .eq(\"slug\", slug)\n    .single();\n\n  if (product) {\n    return { found: true, product };\n  }\n\n  const { data: history } = await supabase\n    .from(\"slug_history\")\n    .select(\"new_slug\")\n    .eq(\"old_slug\", slug)\n    .order(\"created_at\", { ascending: false })\n    .limit(1)\n    .single();\n\n  if (history) {\n    return { found: true, redirect: history.new_slug };\n  }\n\n  return { found: false };\n}\n"],"names":[],"mappings":";;;;;AAEA;;;;AAWO,eAAe,wBACpB,IAAY;IAEZ,MAAM,WAAW,MAAM,IAAA,kIAAY;IAEnC,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,YACL,MAAM,CAAC,KACP,EAAE,CAAC,QAAQ,MACX,MAAM;IAET,IAAI,SAAS;QACX,OAAO;YAAE,OAAO;YAAM;QAAQ;IAChC;IAEA,MAAM,EAAE,MAAM,OAAO,EAAE,GAAG,MAAM,SAC7B,IAAI,CAAC,gBACL,MAAM,CAAC,YACP,EAAE,CAAC,YAAY,MACf,KAAK,CAAC,cAAc;QAAE,WAAW;IAAM,GACvC,KAAK,CAAC,GACN,MAAM;IAET,IAAI,SAAS;QACX,OAAO;YAAE,OAAO;YAAM,UAAU,QAAQ,QAAQ;QAAC;IACnD;IAEA,OAAO;QAAE,OAAO;IAAM;AACxB;;;IA5BsB;;AAAA,+OAAA"}},
    {"offset": {"line": 348, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/actions/analytics/reset-analytics.ts"],"sourcesContent":["\"use server\";\n\nimport { env } from \"@/app/env\";\nimport { createClient as createSupabaseClient } from \"@supabase/supabase-js\";\nimport { createClient } from \"@/supabase/server\";\nimport { revalidatePath } from \"next/cache\";\n\nexport interface ResetAnalyticsResult {\n  success: boolean;\n  message: string;\n  deletedCounts?: {\n    pageViews: number;\n    sessions: number;\n    events: number;\n  };\n}\n\nexport async function resetAnalyticsData(): Promise<ResetAnalyticsResult> {\n  // 1. Kullanıcı yetki kontrolü için standart client\n  const supabase = await createClient();\n  const {\n    data: { user },\n  } = await supabase.auth.getUser();\n\n  if (!user) {\n    return {\n      success: false,\n      message: \"Yetkisiz erişim. Lütfen giriş yapın.\",\n    };\n  }\n\n  // 2. Silme işlemi için Service Role client (Bypass RLS)\n  const supabaseAdmin = createSupabaseClient(\n    env.NEXT_PUBLIC_SUPABASE_URL,\n    env.SUPABASE_SERVICE_ROLE_OR_SECRET_KEY,\n    {\n      auth: {\n        autoRefreshToken: false,\n        persistSession: false,\n      },\n    },\n  );\n\n  try {\n    const pageViewsResult = await supabaseAdmin\n      .from(\"page_views\")\n      .delete()\n      .neq(\"id\", \"00000000-0000-0000-0000-000000000000\")\n      .select(\"id\"); // Select ile dönen datayı sayabiliriz\n\n    if (pageViewsResult.error) {\n      console.error(\"Page views delete error:\", pageViewsResult.error);\n      return {\n        success: false,\n        message: `Sayfa görüntüleme verileri silinemedi: ${pageViewsResult.error.message}`,\n      };\n    }\n\n    const sessionsResult = await supabaseAdmin\n      .from(\"sessions\")\n      .delete()\n      .neq(\"id\", \"00000000-0000-0000-0000-000000000000\")\n      .select(\"id\");\n\n    if (sessionsResult.error) {\n      console.error(\"Sessions delete error:\", sessionsResult.error);\n      return {\n        success: false,\n        message: `Oturum verileri silinemedi: ${sessionsResult.error.message}`,\n      };\n    }\n\n    const eventsResult = await supabaseAdmin\n      .from(\"analytics_events\")\n      .delete()\n      .neq(\"id\", \"00000000-0000-0000-0000-000000000000\")\n      .select(\"id\");\n\n    if (eventsResult.error) {\n      console.error(\"Events delete error:\", eventsResult.error);\n      return {\n        success: false,\n        message: `Event verileri silinemedi: ${eventsResult.error.message}`,\n      };\n    }\n\n    const deletedCounts = {\n      pageViews: pageViewsResult.data?.length ?? 0,\n      sessions: sessionsResult.data?.length ?? 0,\n      events: eventsResult.data?.length ?? 0,\n    };\n\n    revalidatePath(\"/dashboard\");\n    revalidatePath(\"/tr/dashboard\");\n    revalidatePath(\"/en/dashboard\");\n\n    return {\n      success: true,\n      message: \"Analitik verileri başarıyla sıfırlandı.\",\n      deletedCounts,\n    };\n  } catch (error) {\n    console.error(\"Analytics reset error:\", error);\n    return {\n      success: false,\n      message: `Veriler sıfırlanırken bir hata oluştu: ${error instanceof Error ? error.message : \"Bilinmeyen hata\"}`,\n    };\n  }\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;;;;;;;AAYO,eAAe;IACpB,mDAAmD;IACnD,MAAM,WAAW,MAAM,IAAA,kIAAY;IACnC,MAAM,EACJ,MAAM,EAAE,IAAI,EAAE,EACf,GAAG,MAAM,SAAS,IAAI,CAAC,OAAO;IAE/B,IAAI,CAAC,MAAM;QACT,OAAO;YACL,SAAS;YACT,SAAS;QACX;IACF;IAEA,wDAAwD;IACxD,MAAM,gBAAgB,IAAA,8LAAoB,EACxC,iHAAG,CAAC,wBAAwB,EAC5B,iHAAG,CAAC,mCAAmC,EACvC;QACE,MAAM;YACJ,kBAAkB;YAClB,gBAAgB;QAClB;IACF;IAGF,IAAI;QACF,MAAM,kBAAkB,MAAM,cAC3B,IAAI,CAAC,cACL,MAAM,GACN,GAAG,CAAC,MAAM,wCACV,MAAM,CAAC,OAAO,sCAAsC;QAEvD,IAAI,gBAAgB,KAAK,EAAE;YACzB,QAAQ,KAAK,CAAC,4BAA4B,gBAAgB,KAAK;YAC/D,OAAO;gBACL,SAAS;gBACT,SAAS,CAAC,uCAAuC,EAAE,gBAAgB,KAAK,CAAC,OAAO,EAAE;YACpF;QACF;QAEA,MAAM,iBAAiB,MAAM,cAC1B,IAAI,CAAC,YACL,MAAM,GACN,GAAG,CAAC,MAAM,wCACV,MAAM,CAAC;QAEV,IAAI,eAAe,KAAK,EAAE;YACxB,QAAQ,KAAK,CAAC,0BAA0B,eAAe,KAAK;YAC5D,OAAO;gBACL,SAAS;gBACT,SAAS,CAAC,4BAA4B,EAAE,eAAe,KAAK,CAAC,OAAO,EAAE;YACxE;QACF;QAEA,MAAM,eAAe,MAAM,cACxB,IAAI,CAAC,oBACL,MAAM,GACN,GAAG,CAAC,MAAM,wCACV,MAAM,CAAC;QAEV,IAAI,aAAa,KAAK,EAAE;YACtB,QAAQ,KAAK,CAAC,wBAAwB,aAAa,KAAK;YACxD,OAAO;gBACL,SAAS;gBACT,SAAS,CAAC,2BAA2B,EAAE,aAAa,KAAK,CAAC,OAAO,EAAE;YACrE;QACF;QAEA,MAAM,gBAAgB;YACpB,WAAW,gBAAgB,IAAI,EAAE,UAAU;YAC3C,UAAU,eAAe,IAAI,EAAE,UAAU;YACzC,QAAQ,aAAa,IAAI,EAAE,UAAU;QACvC;QAEA,IAAA,+IAAc,EAAC;QACf,IAAA,+IAAc,EAAC;QACf,IAAA,+IAAc,EAAC;QAEf,OAAO;YACL,SAAS;YACT,SAAS;YACT;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,0BAA0B;QACxC,OAAO;YACL,SAAS;YACT,SAAS,CAAC,uCAAuC,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,mBAAmB;QACjH;IACF;AACF;;;IA3FsB;;AAAA,+OAAA"}},
    {"offset": {"line": 435, "column": 0}, "map": {"version":3,"sources":["file:///Users/enesbayraktar/Workspace/sistemgranit/.next-internal/server/app/%5Blocale%5D/dashboard/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {getProductTrend as '4072766151c0ae423696cfa88aab948756132ee153'} from 'ACTIONS_MODULE0'\nexport {getVisitorStats as '4013d0555fdeccdf1bdf3542b9ecbfd714dbe497e8'} from 'ACTIONS_MODULE1'\nexport {getPopularPages as '60d199e42ab4f4c93c7c7225ceb9a3417a632e3aa1'} from 'ACTIONS_MODULE2'\nexport {getProductStats as '00429229d73b89a3704d1c3ebe57ad82cef737b4a0'} from 'ACTIONS_MODULE3'\nexport {getCategoryDistribution as '00e17a7b49401551dd5ece86b8c1665fc10866e5a8'} from 'ACTIONS_MODULE4'\nexport {getDailyAnalytics as '40e6975de1b1b6415dd3606044fe1ef1d75d1a966d'} from 'ACTIONS_MODULE5'\nexport {resolveSlugWithRedirect as '4022e5374ea159f3545f609cad69b1314fa818c2e8'} from 'ACTIONS_MODULE6'\nexport {resetAnalyticsData as '0017428c3285694a25164bfd0884720636fb31856b'} from 'ACTIONS_MODULE7'\n"],"names":[],"mappings":";AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA"}}]
}